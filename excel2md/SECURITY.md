# セキュリティポリシー

## サポートバージョン

最新バージョンをサポートしています：

| バージョン | サポート状況       |
| ---------- | ------------------ |
| 2.0.x      | :white_check_mark: |
| < 2.0      | :x:                |

## 脆弱性の報告

excel2md にセキュリティ上の脆弱性を発見した場合は、以下の手順に従って責任ある報告をお願いします：

### 報告方法

1. セキュリティ脆弱性に関して公開の GitHub Issue を作成**しないでください**
2. 以下の方法でメンテナーに詳細なレポートを送信してください：
   - GitHub のプライベートセキュリティアドバイザリを作成する（推奨）
   - 重大度の低い問題については「security」ラベルを付けて Issue を作成する

### 報告に含める内容

レポートには以下の情報を含めてください：

- 脆弱性の説明
- 問題を再現する手順
- 潜在的な影響と重大度
- 修正案や緩和策の提案
- 連絡先情報（任意）

### 報告例

```
件名: [SECURITY] Excel パース時の潜在的な XXE 脆弱性

説明:
特別に細工された Excel ファイルを処理する際、openpyxl ライブラリは
XML 外部エンティティ（XXE）攻撃に対して脆弱である可能性があります。

再現手順:
1. 外部エンティティ参照を含む悪意のある Excel ファイルを作成
2. そのファイルに対して excel2md を実行
3. 情報漏洩の可能性を確認

影響:
攻撃者がローカルファイルを読み取ったり、サービス拒否を引き起こす可能性があります。

修正案:
openpyxl の設定で外部エンティティ処理を無効化する。
```

## 対応スケジュール

- **初回応答**: 48時間以内
- **状況更新**: 7日以内
- **解決**: 重大度に応じて
  - 緊急: 14日以内
  - 高: 30日以内
  - 中: 60日以内
  - 低: 次回リリースサイクル

## セキュリティに関する考慮事項

### ファイル処理

excel2md は以下を含む可能性のある Excel ファイルを処理します：

- マクロ（`.xlsm` ファイル）
- 外部リンクと参照
- 埋め込みオブジェクト
- 副作用を持つ可能性のある数式

**推奨事項:**

1. 信頼できるソースからの Excel ファイルのみを処理する
2. 外部ソースから受け取ったファイルは処理前に確認する
3. 信頼できないファイルを処理する場合は、サンドボックス環境で excel2md を実行する
4. マクロを含むファイルには注意する（ただし excel2md 自体はマクロを実行しません）

### 入力検証

excel2md には以下のセキュリティ対策が含まれています：

- openpyxl で `read_only=True` モードを使用してファイルの変更を防止
- `data_only=True` を使用して数式の実行を回避
- `max_cells_per_table` オプションでセル処理を制限
- インジェクション攻撃を防ぐため Markdown 出力をサニタイズ

### 出力のセキュリティ

生成された Markdown ファイルを使用する際の注意点：

- Excel ファイルのハイパーリンクは出力に保持されることに注意
- 公開前に生成された Markdown を確認する
- ソースの Excel ファイルに含まれる悪意のある URL に注意する
- URL を除外したい場合は `--hyperlink-mode text_only` を使用する

### 依存関係

このプロジェクトは以下に依存しています：

- `openpyxl >= 3.1.5`: Excel ファイル処理

これらの依存関係のセキュリティアドバイザリを監視し、必要に応じて更新しています。

## セキュリティのベストプラクティス

excel2md を使用する際の推奨事項：

1. **最新版を維持**: 常に最新バージョンを使用する
2. **入力を確認**: 処理前に Excel ファイルを検査する
3. **サンドボックス処理**: 信頼できないファイルにはコンテナや VM を使用する
4. **出力を検証**: 使用前に生成された Markdown を確認する
5. **権限を制限**: 必要最小限の権限で実行する
6. **依存関係を監視**: openpyxl やその他の依存関係を最新に保つ

## 既知のセキュリティ制限

1. **マクロ検出**: excel2md はマクロを実行しませんが、その存在を警告しません
2. **外部リンク**: Excel ファイル内の外部リンクは処理されますが、検証されません
3. **ファイルサイズ**: 非常に大きなファイルはメモリの問題を引き起こす可能性があります。`max_cells_per_table` で制限してください
4. **数式処理**: 数式は値として表示されます。複雑な数式は検証されません

## セキュリティアップデート

セキュリティアップデートは以下の形式でリリースされます：

- 軽微な問題にはパッチバージョン（例: 2.0.1）
- 重大な問題にはマイナーバージョン（例: 2.1.0）
- CHANGELOG.md に `[SECURITY]` プレフィックス付きで記載

## 謝辞

脆弱性を責任を持って報告してくださるセキュリティ研究者に感謝します。有効なセキュリティ問題を報告された方は、以下で謝辞を記載します：

- CHANGELOG.md（匿名を希望される場合を除く）
- 修正のリリースノート

## ご質問

脆弱性ではないセキュリティ関連のご質問は、以下の方法でお問い合わせください：

- 「security」ラベルを付けて Issue を作成
- メンテナーに連絡

