# バージョン切替用 map 設定
# 新バージョン追加時はここを更新

# Cookie値に応じてバックエンドポートを振り分け
map $cookie_app_version $backend_port {
    "v0.5.2"  8052;
    "v0.5.1"  8051;
    "v0.5.0"  8050;
    default   8052;  # latest (v0.5.2)
}

# Cookie値に応じてフロントエンドを振り分け
map $cookie_app_version $frontend_root {
    "v0.5.2"  /var/www/spec-code-ai-reviewer/versions/v0.5.2/frontend;
    "v0.5.1"  /var/www/spec-code-ai-reviewer/versions/v0.5.1/frontend;
    "v0.5.0"  /var/www/spec-code-ai-reviewer/versions/v0.5.0/frontend;
    default   /var/www/spec-code-ai-reviewer/latest/frontend;
}
