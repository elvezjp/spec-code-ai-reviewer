# バージョン切替用 map 設定
# 新バージョン追加時はここを更新

# Cookie値に応じてバックエンドポートを振り分け
map $cookie_app_version $backend_port {
    "v0.5.0"  8050;
    "v0.4.0"  8040;
    "v0.3.0"  8030;
    "v0.2.5"  8025;
    "v0.1.1"  8011;
    default   8050;  # latest (v0.5.0)
}

# Cookie値に応じてフロントエンドを振り分け
map $cookie_app_version $frontend_root {
    "v0.5.0"  /var/www/spec-code-ai-reviewer/versions/v0.5.0/frontend;
    "v0.4.0"  /var/www/spec-code-ai-reviewer/versions/v0.4.0/frontend;
    "v0.3.0"  /var/www/spec-code-ai-reviewer/versions/v0.3.0/frontend;
    "v0.2.5"  /var/www/spec-code-ai-reviewer/versions/v0.2.5/frontend;
    "v0.1.1"  /var/www/spec-code-ai-reviewer/versions/v0.1.1/frontend;
    default   /var/www/spec-code-ai-reviewer/latest/frontend;
}
