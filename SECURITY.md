# セキュリティポリシー

## サポートバージョン

最新バージョンをサポートしています：

| バージョン | サポート状況       |
| ---------- | ------------------ |
| 0.7      | :white_check_mark: |
| < 0.6      | :x:                |

## 脆弱性の報告

spec-code-ai-reviewer にセキュリティ上の脆弱性を発見した場合は、以下の手順に従って責任ある報告をお願いします：

### 報告方法

1. セキュリティ脆弱性に関して公開の GitHub Issue を作成**しないでください**
2. 以下の方法でメンテナーに詳細なレポートを送信してください：
   - GitHub のプライベートセキュリティアドバイザリを作成する（推奨）
   - 重大度の低い問題については「security」ラベルを付けて Issue を作成する

### 報告に含める内容

レポートには以下の情報を含めてください：

- 脆弱性の説明
- 問題を再現する手順
- 潜在的な影響と重大度
- 修正案や緩和策の提案
- 連絡先情報（任意）

### 報告例

```
件名: [SECURITY] ファイルアップロード時の潜在的な脆弱性

説明:
特別に細工された Excel ファイルをアップロードする際、
サーバー側で予期しない動作が発生する可能性があります。

再現手順:
1. 悪意のあるマクロを含む Excel ファイルを作成
2. そのファイルをアップロード
3. 変換処理を実行

影響:
サーバーリソースの過剰消費やサービス拒否を引き起こす可能性があります。

修正案:
ファイルサイズとセル数の制限を強化する。
```

## 対応スケジュール

- **初回応答**: 48時間以内
- **状況更新**: 7日以内
- **解決**: 重大度に応じて
  - 緊急: 14日以内
  - 高: 30日以内
  - 中: 60日以内
  - 低: 次回リリースサイクル

## セキュリティに関する考慮事項

### ファイル処理

spec-code-ai-reviewer は以下を含む可能性のあるファイルを処理します：

- Excel ファイル（マクロ、外部リンク、埋め込みオブジェクト）
- ソースコードファイル（任意のテキストファイル）
- 設定ファイル（API キー、認証情報）

**推奨事項:**

1. 信頼できるソースからのファイルのみを処理する
2. 外部ソースから受け取ったファイルは処理前に確認する
3. 信頼できないファイルを処理する場合は、サンドボックス環境で実行する
4. API キーや認証情報を含む設定ファイルは慎重に管理する

### API キーの管理

このアプリケーションは以下の API を使用する可能性があります：

- AWS Bedrock
- Anthropic API
- OpenAI API

**推奨事項:**

1. API キーを環境変数で管理し、コードにハードコードしない
2. 最小権限の原則に従い、必要な権限のみを付与する
3. API キーを定期的にローテーションする
4. 本番環境と開発環境で異なる API キーを使用する

### 入力検証

spec-code-ai-reviewer には以下のセキュリティ対策が含まれています：

- Excel ファイル処理時に `read_only=True` モードを使用
- ファイルサイズの制限
- 入力ファイルの検証

### 出力のセキュリティ

生成されたレビューレポートを使用する際の注意点：

- レポートには入力ファイルの内容が含まれる可能性があります
- 機密情報を含むファイルをレビューした場合、レポートにも機密情報が含まれます
- レポートを共有する前に内容を確認してください

### 依存関係

このプロジェクトは以下の主要な依存関係を使用しています：

- `fastapi`: Web フレームワーク
- `markitdown`: Excel → Markdown 変換
- `openpyxl`: Excel ファイル処理
- `boto3`: AWS Bedrock 連携
- `anthropic`: Anthropic API 連携
- `openai`: OpenAI API 連携

これらの依存関係のセキュリティアドバイザリを監視し、必要に応じて更新しています。

## セキュリティのベストプラクティス

spec-code-ai-reviewer を使用する際の推奨事項：

1. **最新版を維持**: 常に最新バージョンを使用する
2. **入力を確認**: 処理前にファイルを検査する
3. **サンドボックス処理**: 信頼できないファイルにはコンテナや VM を使用する
4. **出力を検証**: 使用前に生成されたレポートを確認する
5. **権限を制限**: 必要最小限の権限で実行する
6. **依存関係を監視**: 依存ライブラリを最新に保つ
7. **認証情報を保護**: API キーを安全に管理する

## 既知のセキュリティ制限

1. **マクロ検出**: Excel ファイルのマクロは実行されませんが、その存在を警告しません
2. **外部リンク**: Excel ファイル内の外部リンクは処理されますが、検証されません
3. **ファイルサイズ**: 非常に大きなファイルはメモリの問題を引き起こす可能性があります
4. **LLM 出力**: AI による出力は常に正確とは限りません。重要な判断には人間の確認が必要です

## セキュリティアップデート

セキュリティアップデートは以下の形式でリリースされます：

- 軽微な問題にはパッチバージョン（例: 0.5.1）
- 重大な問題にはマイナーバージョン（例: 0.6.0）
- CHANGELOG.md に `[SECURITY]` プレフィックス付きで記載

## 謝辞

脆弱性を責任を持って報告してくださるセキュリティ研究者に感謝します。有効なセキュリティ問題を報告された方は、以下で謝辞を記載します：

- CHANGELOG.md（匿名を希望される場合を除く）
- 修正のリリースノート

## ご質問

脆弱性ではないセキュリティ関連のご質問は、以下の方法でお問い合わせください：

- 「security」ラベルを付けて Issue を作成
- メンテナーに連絡
